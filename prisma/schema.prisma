generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Lot {
  id String @id @default(uuid())

  // DOCS INFO
  insurance    EInsurance
  region       String
  city         String
  price        Int
  currentPrice Int?
  // CAR INFO
  vin          String
  frame        String
  carType      ECarTypes
  year         Int
  bodyType     ECarBodyTypes
  color        String
  mileage      Int
  passport     String
  engineType   EEngineTypes
  volume       Int
  power        Int
  drive        EDrive
  gearbox      EGearbox
  comment      String?
  photos       String[]
  name         String
  damages      String?

  bets     Bet[]
  status   ELotStatuses @default(available)
  winnerId String?

  seller   User   @relation(fields: [sellerId], references: [id])
  sellerId String

  createdAt DateTime @default(now())
  endsAt    DateTime
}

model User {
  id String @id @default(uuid())

  name     String
  email    String    @unique()
  password String
  phone    String    @unique
  birthday DateTime?
  avatar   String?
  balance Int @default(0)

  role EUserRoles

  lots Lot[]
  bets Bet[]
}

model Bet {
  id String @id @default(uuid())

  bet Int

  lot   Lot    @relation(fields: [lotId], references: [id], onDelete: Cascade)
  lotId String

  user   User   @relation(fields: [userId], references: [id])
  userId String

  createdAt DateTime @default(now())
}

enum EInsurance {
  OSAGO
  CASCO
}

enum ECarTypes {
  passenger
  commercial
  motorcycle
  cargo
  trailer
  bus
  special
}

enum ECarBodyTypes {
  jeep
  coupe
  hatchback
  sedan
  offroad
  van
  cabrio
  pickup
}

enum EEngineTypes {
  petrol
  diesel
  electric
  hybrid
}

enum EDrive {
  front
  rear
  all
}

enum EGearbox {
  automatic
  manual
}

enum EUserRoles {
  seller
  auctioneer
}

enum ELotStatuses {
  available
  finished
}
